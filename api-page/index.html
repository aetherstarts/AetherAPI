<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aether API</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <style> 
        :root { --primary-blue: #2563eb; --text-dark: #1e293b; --text-light: #64748b; --bg-soft: #f8fafc; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-soft); color: var(--text-dark); margin: 0; }

        /* --- LOADING SCREEN --- */
        #loadingScreen { position: fixed; inset: 0; background: white; z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.8s; }
        .spinner { width: 45px; height: 45px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-blue); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* --- HEADER LAYOUT (PERSIS FOTO) --- */
        .header-container { padding: 60px 25px 0px 25px; }
        .title-wrapper { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        #main-title { font-size: 34px; font-weight: 700; margin: 0; letter-spacing: -0.5px; }
        .version-badge { background-color: var(--primary-blue); color: white; font-size: 11px; font-weight: 600; padding: 2px 10px; border-radius: 50px; }
        #description { font-size: 15px; color: var(--text-light); line-height: 1.4; margin-bottom: 20px; }
        .links-wrapper { display: flex; flex-direction: column; gap: 2px; }
        .custom-link { color: var(--primary-blue); text-decoration: none; font-size: 15px; font-weight: 500; }

        /* --- API LIST --- */
        .section-title { font-size: 22px; font-weight: 700; margin: 35px 25px 15px 25px; position: relative; padding-bottom: 8px; border-bottom: 3px solid var(--primary-blue); }
        .api-card { background: white; margin: 0px 25px 12px 25px; padding: 20px; border-radius: 12px; border: 1px solid #eef2f6; }
        .api-card h5 { font-size: 17px; font-weight: 600; margin-bottom: 4px; }
        .api-card p { font-size: 13px; color: #94a3b8; margin-bottom: 15px; }
        .btn-try { background-color: var(--primary-blue); color: white; border: none; padding: 8px 18px; border-radius: 8px; font-weight: 600; font-size: 13px; }

        /* --- MODAL --- */
        .modal-content { border-radius: 15px; border: none; }
        .modal-body input { border-radius: 10px; border: 1px solid #eee; padding: 12px; margin-bottom: 15px; width: 100%; }
        .btn-submit { background-color: var(--primary-blue); color: white; width: 100px; border-radius: 8px; font-weight: 600; float: right; border: none; padding: 10px; }
        pre#apiResponse { background: #1e293b; color: #38bdf8; padding: 15px; border-radius: 10px; font-size: 12px; margin-top: 50px; white-space: pre-wrap; display: none; }
    </style>
</head>
<body>

    <div id="loadingScreen">
        <div class="spinner"></div>
        <h2 style="color: var(--primary-blue); font-weight: 700;">Aether Api</h2>
    </div>

    <div class="header-container">
        <div class="title-wrapper">
            <h1 id="main-title">Aether Api</h1>
            <span class="version-badge">v1.0</span>
        </div>
        <p id="description">Loading description...</p>
        <div class="links-wrapper">
            <a href="#" class="custom-link">Join Channel WhatsApp</a>
            <a href="#" class="custom-link">Contact Developer</a>
        </div>
    </div>

    <div id="apiLists"></div>

    <footer style="text-align: center; padding: 40px 0; color: var(--text-light); font-size: 13px;">
        Â© 2025 Aether. All rights reserved.
    </footer>

    <div class="modal fade" id="apiModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="fw-bold" id="modalTitle"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted small" id="modalDesc" style="margin-top: -15px;"></p>
                    <div id="inputContainer"></div>
                    <button class="btn btn-submit" onclick="submitApi()">Submit</button>
                    <pre id="apiResponse"></pre>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentPath = "";

        // LOAD DATA DARI SETTINGS.JSON
        async function init() {
            try {
                const response = await fetch('/src/settings.json');
                const data = await response.json();
                
                document.getElementById('description').innerText = data.description;

                const listDiv = document.getElementById('apiLists');
                data.categories.forEach(cat => {
                    let html = `<h3 class="section-title">${cat.name}</h3>`;
                    cat.items.forEach(item => {
                        const params = item.params ? Object.keys(item.params) : [];
                        html += `
                            <div class="api-card">
                                <h5>${item.name}</h5>
                                <p>${item.desc}</p>
                                <button class="btn-try" onclick="openModal('${item.name}', '${item.desc}', '${item.path}', ${JSON.stringify(params)})">Try API</button>
                            </div>`;
                    });
                    listDiv.innerHTML += html;
                });
            } catch (e) { console.log(e); }
        }

        function openModal(name, desc, path, params) {
            currentPath = path.split('?')[0];
            document.getElementById('modalTitle').innerText = name;
            document.getElementById('modalDesc').innerText = desc;
            document.getElementById('apiResponse').style.display = 'none';
            const container = document.getElementById('inputContainer');
            container.innerHTML = "";
            params.forEach(p => {
                container.innerHTML += `<input type="text" id="p_${p}" placeholder="Enter ${p}...">`;
            });
            new bootstrap.Modal(document.getElementById('apiModal')).show();
        }

        async function submitApi() {
            const resBox = document.getElementById('apiResponse');
            resBox.style.display = 'block';
            resBox.innerText = "Processing...";

            let query = new URLSearchParams();
            document.querySelectorAll('#inputContainer input').forEach(i => {
                query.append(i.id.replace('p_', ''), i.value);
            });

            try {
                const r = await fetch(`${currentPath}?${query.toString()}`);
                const result = await r.json();
                resBox.innerText = JSON.stringify(result, null, 2);
            } catch (e) { resBox.innerText = "Error!"; }
        }

        window.onload = () => {
            init();
            setTimeout(() => {
                const loader = document.getElementById('loadingScreen');
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 800);
            }, 3000);
        };
    </script>
</body>
</html>